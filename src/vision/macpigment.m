function [macp] = macpigment(spectralrange, spline)
  
    if nargin < 2, spline = 0; end
    if nargin < 1, spectralrange = 380:1:780; end
   
    x = 390:1:830;
    y = [   0.045330000000000
   0.049180000000000
   0.053040000000000
   0.056930000000000
   0.060870000000000
   0.064890000000000
   0.069000000000000
   0.073220000000000
   0.077580000000000
   0.082100000000000
   0.086800000000000
   0.091680000000000
   0.096700000000000
   0.101800000000000
   0.106920000000000
   0.112000000000000
   0.116990000000000
   0.121920000000000
   0.126790000000000
   0.131640000000000
   0.136500000000000
   0.141400000000000
   0.146420000000000
   0.151650000000000
   0.157180000000000
   0.163100000000000
   0.169470000000000
   0.176240000000000
   0.183320000000000
   0.190630000000000
   0.198100000000000
   0.205640000000000
   0.213140000000000
   0.220520000000000
   0.227670000000000
   0.234500000000000
   0.240910000000000
   0.246870000000000
   0.252360000000000
   0.257340000000000
   0.261800000000000
   0.265730000000000
   0.269160000000000
   0.272180000000000
   0.274840000000000
   0.277200000000000
   0.279340000000000
   0.281390000000000
   0.283490000000000
   0.285780000000000
   0.288400000000000
   0.291460000000000
   0.294970000000000
   0.298920000000000
   0.303260000000000
   0.308000000000000
   0.313070000000000
   0.318320000000000
   0.323550000000000
   0.328580000000000
   0.333200000000000
   0.337270000000000
   0.340800000000000
   0.343830000000000
   0.346410000000000
   0.348600000000000
   0.350390000000000
   0.351630000000000
   0.352110000000000
   0.351640000000000
   0.350000000000000
   0.347070000000000
   0.343040000000000
   0.338160000000000
   0.332700000000000
   0.326900000000000
   0.321010000000000
   0.315200000000000
   0.309590000000000
   0.304350000000000
   0.299600000000000
   0.295460000000000
   0.291910000000000
   0.288880000000000
   0.286330000000000
   0.284200000000000
   0.282440000000000
   0.281020000000000
   0.279920000000000
   0.279120000000000
   0.278600000000000
   0.278320000000000
   0.278180000000000
   0.278030000000000
   0.277750000000000
   0.277200000000000
   0.276280000000000
   0.274970000000000
   0.273280000000000
   0.271220000000000
   0.268800000000000
   0.266000000000000
   0.262700000000000
   0.258780000000000
   0.254090000000000
   0.248500000000000
   0.241930000000000
   0.234520000000000
   0.226480000000000
   0.218000000000000
   0.209300000000000
   0.200530000000000
   0.191740000000000
   0.182920000000000
   0.174070000000000
   0.165200000000000
   0.156310000000000
   0.147430000000000
   0.138580000000000
   0.129790000000000
   0.121100000000000
   0.112540000000000
   0.104190000000000
   0.096120000000000
   0.088430000000000
   0.081200000000000
   0.074490000000000
   0.068300000000000
   0.062590000000000
   0.057330000000000
   0.052500000000000
   0.048060000000000
   0.043950000000000
   0.040100000000000
   0.036440000000000
   0.032900000000000
   0.029440000000000
   0.026100000000000
   0.022950000000000
   0.020060000000000
   0.017500000000000
   0.015310000000000
   0.013450000000000
   0.011870000000000
   0.010500000000000
   0.009290000000000
   0.008180000000000
   0.007160000000000
   0.006220000000000
   0.005370000000000
   0.004590000000000
   0.003890000000000
   0.003250000000000
   0.002680000000000
   0.002150000000000
   0.001660000000000
   0.001210000000000
   0.000810000000000
   0.000460000000000
   0.000190000000000
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0
                   0];
    if spline==0           
        macp = interp1(x, y, spectralrange, 'pchip', "extrap");
    else
        macp = interp1(x, y, spectralrange, "spline", "extrap");
    end
end